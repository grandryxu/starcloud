<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.xywg.admin.modular.report.dao.DistrictReportMapper">


     <!--根据社会信用统一代码 按区域分组获取项目统计数据-->
    <select id="getReportListByOrganizationCodeList" resultType="com.xywg.admin.modular.report.model.DistrictReport">
        select
            count(c.project_code) as amount,
            m.area_code as  areaCode,
            IFNULL(a.shortname,'其他') as birthPlace
        from buss_project_sub_contractor   c
        left join buss_project_master  m   on  c.project_code=m.project_code
        left join ref_area   a  on  a.id = concat(left(m.area_code,3),"000")
        where c.is_del=0  and  m.is_del=0   and
            c.organization_code in
            <foreach collection="list" close=")" open="(" separator="," index="index" item="item">
                #{item}
            </foreach>
        GROUP BY  a.shortname
    </select>
</mapper>
