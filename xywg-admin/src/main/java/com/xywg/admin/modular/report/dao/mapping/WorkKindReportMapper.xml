<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.xywg.admin.modular.report.dao.WorkKindReportMapper">

    <!-- 获取公司的某项目的工人工种分布 yuanyang -->
    <select id="getWorkKindList" resultType="map">
        SELECT
        w.work_type_code as work_type_code,
        COUNT(DISTINCT w.id) as
        count,
        d.name as workKind
        from
        buss_worker_master w left join sys_dict d
        on d.num=w.work_type_code and d.pid=(select id from sys_dict where name='工种字典数据')
        left join buss_contractor_worker cw on cw.id_card_number=w.id_card_number and cw.id_card_type=w.id_card_type
        where  cw.organization_code in
        <foreach collection="list" close=")" open="(" separator="," index="index" item="item">
        #{item}
        </foreach>
        and w.is_del=0  AND w.work_type_code IS NOT null
        GROUP BY w.work_type_code
    </select>
</mapper>
